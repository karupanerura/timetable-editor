(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{153:function(t,e,n){var content=n(161);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("089b1614",content,!0,{sourceMap:!1})},154:function(t,e,n){var content=n(163);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("a12839fc",content,!0,{sourceMap:!1})},155:function(t,e,n){var content=n(166);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(51).default)("f2488e72",content,!0,{sourceMap:!1})},160:function(t,e,n){"use strict";var r=n(153);n.n(r).a},161:function(t,e,n){(t.exports=n(50)(!1)).push([t.i,".tracks[data-v-75ce6f86]{display:table;width:100%;height:64px}.track[data-v-75ce6f86]{display:table-cell}",""])},162:function(t,e,n){"use strict";var r=n(154);n.n(r).a},163:function(t,e,n){(t.exports=n(50)(!1)).push([t.i,".timespans[data-v-a70db94c]{display:flex;flex-flow:column nowrap;width:100%}.timespan[data-v-a70db94c]{height:64px}",""])},165:function(t,e,n){"use strict";var r=n(155);n.n(r).a},166:function(t,e,n){(t.exports=n(50)(!1)).push([t.i,".timetable[data-v-979478a6]{display:flex;flex-flow:row nowrap;width:100%}.timetable-timespans[data-v-979478a6]{margin-top:64px;width:240px}.timetable-contents[data-v-979478a6]{width:100%}",""])},175:function(t,e,n){"use strict";n.r(e);n(96),n(97),n(14);var r=n(145),o=n(146),c=n(151),l=n(148),m=n(150),f=n(22),d=n(149),h=(n(152),n(52),regeneratorRuntime.mark(v));function v(t,e){var n,i,r=arguments;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=r.length>2&&void 0!==r[2]?r[2]:1,i=t;case 2:if(!(i<=e)){o.next=8;break}return o.next=5,i;case 5:i+=n,o.next=2;break;case 8:case"end":return o.stop()}},h)}var y={components:{},props:{count:{type:Number,default:2}},data:function(){return{}},computed:{tracks:function(){return v(1,this.count)}}},O=(n(160),n(18)),T=Object(O.a)(y,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tracks"},t._l(t.tracks,function(track){return n("div",{key:track,staticClass:"track"},[t._v("\n    "+t._s(track)+"\n  ")])}),0)},[],!1,null,"75ce6f86",null).exports,j={components:{},props:{items:{type:Array,default:function(){return[]}}},data:function(){return{}}},k=(n(162),Object(O.a)(j,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"timespans"},t._l(t.items,function(e){return n("div",{key:e.toString(),staticClass:"timespan"},[n("time",[t._v(t._s(e.beginsTime))]),t._v(" ~ "),n("time",[t._v(t._s(e.endsTime))])])}),0)},[],!1,null,"a70db94c",null).exports),w=n(164),_={components:{GridLayout:w.GridLayout,GridItem:w.GridItem},props:{grids:{type:Array,default:function(){return[]}},columns:{type:Number,default:2},rows:{type:Number,default:2},rowHeight:{type:Number,default:64}},data:function(){return{}},methods:{encodeJSON:JSON.stringify}},x=Object(O.a)(_,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("grid-layout",{attrs:{layout:t.grids,"col-num":t.columns,"max-rows":t.rows,margin:[0,0],"row-height":t.rowHeight,"is-draggable":!0,"is-resizable":!0,"use-css-transforms":!0},on:{"update:layout":function(e){t.grids=e}}},t._l(t.grids,function(e){return n("grid-item",{key:e.i,attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i}},[t._v("\n    "+t._s(e.item.title)),n("br"),t._v(" "),n("small",[t._v(t._s(e.item.description))]),t._v(" "),n("small",[t._v("extras: "+t._s(t.encodeJSON(e.item.extras)))]),t._v(" "),n("small",[t._v("grid: "+t._s(t.encodeJSON(e)))])])}),1)},[],!1,null,null,null).exports,D=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},S=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(o.a)(e,[{key:"timespans",get:function(){return this.timetable.timespans}},{key:"grids",get:function(){return this.timetable.grids}},{key:"rows",get:function(){return this.timetable.timespans.length}},{key:"tracks",get:function(){return this.timetable.tracks}},{key:"columns",get:function(){return this.timetable.tracks}}]),e}(d.f);D([Object(d.c)({type:Object,default:function(){}})],S.prototype,"timetable",void 0);var R=S=D([Object(d.a)({components:{Tracks:T,Timespans:k,Items:x}})],S),E=(n(165),Object(O.a)(R,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"timetable"},[e("div",{staticClass:"timetable-timespans"},[e("timespans",{attrs:{items:this.timespans}})],1),this._v(" "),e("div",{staticClass:"timetable-contents"},[e("tracks",{attrs:{count:this.tracks}}),this._v(" "),e("items",{attrs:{grids:this.grids,columns:this.columns,rows:this.rows,"row-height":64}})],1)])},[],!1,null,"979478a6",null).exports),C=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},P=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(m.a)(e,t),e}(d.f);C([Object(d.d)("tracks",{type:String,default:"2"})],P.prototype,"syncedTracks",void 0);var I,N=P=C([d.a],P),M=Object(O.a)(N,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:"javascript:void(0)"}},[t._v("\n  tracks: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.syncedTracks,expression:"syncedTracks"}],attrs:{type:"number",name:"tracks",min:"2",max:"8"},domProps:{value:t.syncedTracks},on:{input:function(e){e.target.composing||(t.syncedTracks=e.target.value)}}})])},[],!1,null,null,null).exports,B=(n(167),n(27),n(66),n(171),function(){function t(title,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;Object(r.a)(this,t),this.title=title,this.description=e,this.extras=n}return Object(o.a)(t,null,[{key:"fromDTO",value:function(e){return new t(e.title,e.description,e.extras)}}]),t}()),J=(I=0,function(){return++I}),$=function(){function t(e){Object(r.a)(this,t),this.x=0,this.y=0,this.w=1,this.h=1,this.id=J(),this.item=e}return Object(o.a)(t,[{key:"i",get:function(){return"item[".concat(this.id,"]")}}],[{key:"getOrCreate",value:function(e){if(t.cache.has(e))return t.cache.get(e);var n=new t(e);return t.cache.set(e,n),n}}]),t}();$.cache=new WeakMap;var L=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},U=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).apply(this,arguments))).draftTitle="",t.draftDescription="",t}return Object(m.a)(e,t),Object(o.a)(e,[{key:"addItem",value:function(){var title=this.draftTitle,t=this.draftDescription;return new B(title,t)}}]),e}(d.f);L([Object(d.e)()],U.prototype,"draftTitle",void 0),L([Object(d.e)()],U.prototype,"draftDescription",void 0),L([Object(d.b)("create")],U.prototype,"addItem",null);var A=U=L([d.a],U),F=Object(O.a)(A,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:"javascript:void(0)"},on:{submit:function(e){return e.preventDefault(),t.addItem()}}},[t._v("\n  title: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.draftTitle,expression:"draftTitle"}],attrs:{type:"text",name:"title",required:""},domProps:{value:t.draftTitle},on:{input:function(e){e.target.composing||(t.draftTitle=e.target.value)}}}),n("br"),t._v("\n  description: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.draftDescription,expression:"draftDescription"}],attrs:{type:"text",name:"description",required:""},domProps:{value:t.draftDescription},on:{input:function(e){e.target.composing||(t.draftDescription=e.target.value)}}}),t._v(" "),n("button",{attrs:{type:"submit"}},[t._v("\n    add\n  ")])])},[],!1,null,null,null).exports,G=(n(107),n(35)),H=function(){function t(e,n){Object(r.a)(this,t),this.beginsTime=e,this.endsTime=n}return Object(o.a)(t,[{key:"isMoment",value:function(){return this.beginsTime.equals(this.endsTime)}},{key:"isValid",value:function(){return this.beginsTime.compare(this.endsTime)<=0}},{key:"compare",value:function(t){return this.beginsTime.compare(t.beginsTime)||this.endsTime.compare(t.endsTime)}},{key:"includes",value:function(t){return this.beginsTime.compare(t.beginsTime)<=0&&this.endsTime.compare(t.endsTime)>=0}},{key:"conflicts",value:function(t){return this.beginsTime.compare(t.endsTime)<0&&this.endsTime.compare(t.beginsTime)>0}},{key:"equals",value:function(t){return this.beginsTime.equals(t.beginsTime)&&this.endsTime.equals(t.endsTime)}},{key:"toString",value:function(){return this.isMoment()?this.beginsTime.toString():this.beginsTime.toString()+" ~ "+this.endsTime.toString()}}],[{key:"fromDTO",value:function(e){return new t(V.fromDTO(e.beginsTime),V.fromDTO(e.endsTime))}}]),t}(),V=function(){function t(e,n){Object(r.a)(this,t),this.hour=e,this.minute=n}return Object(o.a)(t,[{key:"addMinutes",value:function(e){var n=this.minute+e;return new t(Math.floor(this.hour+n/60)%24,n%60)}},{key:"compare",value:function(time){var t=this.compareHour(time);return 0!==t?t:this.compareMinute(time)}},{key:"equals",value:function(time){return this.hour===time.hour&&this.minute===time.minute}},{key:"compareHour",value:function(time){return this.hour<time.hour?-1:this.hour===time.hour?0:1}},{key:"compareMinute",value:function(time){return this.minute<time.minute?-1:this.minute===time.minute?0:1}},{key:"toString",value:function(){return(this.hour>=10?this.hour.toString():"0"+this.hour.toString())+":"+(this.minute>=10?this.minute.toString():"0"+this.minute.toString())}}],[{key:"parse",value:function(e){var n=e.split(":"),r=Object(G.a)(n,2),o=r[0],c=r[1];return new t(o?parseInt(o):0,c?parseInt(c):0)}},{key:"fromDTO",value:function(e){return new t(e.hour,e.minute)}}]),t}(),W=function(t,e,n,desc){var r,o=arguments.length,c=o<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(c=(o<3?r(c):o>3?r(e,n,c):r(e,n))||c);return o>3&&c&&Object.defineProperty(e,n,c),c},z=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(l.a)(e).apply(this,arguments))).draftBeginsTime="09:00",t.draftEndsTime="09:10",t}return Object(m.a)(e,t),Object(o.a)(e,[{key:"addTimespan",value:function(){if(""!==this.draftBeginsTime)if(""!==this.draftEndsTime){var t=new H(V.parse(this.draftBeginsTime),V.parse(this.draftEndsTime));if(t.isValid())return this.draftBeginsTime=this.draftEndsTime,this.draftEndsTime=V.parse(this.draftBeginsTime).addMinutes(this.timeStep).toString(),t;alert(t+" is invalid timespan")}else alert("ends time is not defined");else alert("begins time is not defined")}}]),e}(d.f);W([Object(d.c)({type:Number,default:10})],z.prototype,"timeStep",void 0),W([Object(d.e)()],z.prototype,"draftBeginsTime",void 0),W([Object(d.e)()],z.prototype,"draftEndsTime",void 0),W([Object(d.b)("create")],z.prototype,"addTimespan",null);var K=z=W([Object(d.a)({computed:{timeStepSeconds:function(){return 60*this.timeStep}}})],z),Q=Object(O.a)(K,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{attrs:{action:"javascript:void(0)"},on:{submit:function(e){return e.preventDefault(),t.addTimespan()}}},[t._v("\n  time span: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.draftBeginsTime,expression:"draftBeginsTime"}],attrs:{type:"time",name:"begins-time",step:t.timeStepSeconds,max:t.draftEndsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}"},domProps:{value:t.draftBeginsTime},on:{input:function(e){e.target.composing||(t.draftBeginsTime=e.target.value)}}}),t._v(" ~ "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.draftEndsTime,expression:"draftEndsTime"}],attrs:{type:"time",name:"ends-time",step:t.timeStepSeconds,min:t.draftBeginsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}"},domProps:{value:t.draftEndsTime},on:{input:function(e){e.target.composing||(t.draftEndsTime=e.target.value)}}}),n("button",{attrs:{type:"submit"}},[t._v("\n    add\n  ")]),n("br")])},[],!1,null,null,null).exports,X=(n(55),n(38),n(71),n(72),n(70),n(28),n(174)),Y=n(24),Z=(n(173),regeneratorRuntime.mark(tt));function tt(t,e){var n,i,r=arguments;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n=r.length>2&&void 0!==r[2]?r[2]:1,i=t;case 2:if(!(i<=e)){o.next=8;break}return o.next=5,i;case 5:i+=n,o.next=2;break;case 8:case"end":return o.stop()}},Z)}function et(object,t){var e=Object.keys(object);return Object.getOwnPropertySymbols&&e.push.apply(e,Object.getOwnPropertySymbols(object)),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e}var nt=function(){function t(e,n,o,c){Object(r.a)(this,t),this.tracks=e,this.timespans=n,this.items=o,this.grids=c}return Object(o.a)(t,[{key:"toDTO",value:function(){var t=this,e=this.grids.map(function(e){var n,r=t.timespans[e.y],o=t.timespans[e.y+e.h-1];n=r.equals(o)?r:new H(r.beginsTime,o.endsTime);var c=Array.from(tt(e.x+1,e.x+e.w));return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?et(source,!0).forEach(function(e){Object(Y.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):et(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}({},e.item,{timespan:n,trackIds:c})});return{tracks:this.tracks,timespans:this.timespans,items:e}}}],[{key:"create",value:function(e,n,r){var o=r.map($.getOrCreate);return new t(e,n,r,o)}},{key:"fromDTO",value:function(e){var n=Math.max.apply(Math,Object(X.a)(e.items.map(function(i){return i.trackIds.length}))),r=e.timespans.map(H.fromDTO),o=e.items.map(B.fromDTO),c=e.items.map(function(t,i){var e=H.fromDTO(t.timespan),n=Array.from(function(t){var i=0,e=0,n=0,o=!0,c=!1,l=void 0;try{for(var m,f=r[Symbol.iterator]();!(o=(m=f.next()).done);o=!0){var d=m.value;if(t.includes(d))0===e&&(e=i),n=i;else if(0!==e)break;i++}}catch(t){c=!0,l=t}finally{try{o||null==f.return||f.return()}finally{if(c)throw l}}return tt(e,n)}(e)),l=o[i],m=$.getOrCreate(l);return m.x=t.trackIds[0]-1,m.y=n[0],m.w=t.trackIds.length,m.h=n.length,c});return new t(n,r,o,c)}}]),t}(),it={components:{Timetable:E,TracksForm:M,ItemForm:F,TimespanForm:Q},data:function(){return{tracks:"2",timespans:[],items:[],loadedContent:null,exportURL:null}},computed:{tracksNum:function(){return parseInt(this.tracks)},timetable:function(){return nt.create(this.tracksNum,this.timespans,this.items)}},methods:{addItem:function(t){this.items.push(t)},addTimespan:function(t){if(!(this.timespans.filter(function(e){return e.equals(t)}).length>0)){var e=this.timespans;e.map(function(e){return t.conflicts(e)}).reduce(function(a,b){return a||b},!1)?alert("Conflict time span: "+this.beginsTime+" ~ "+this.endsTime):(e.push(t),this.timespans=e.sort(function(a,b){return a.compare(b)}))}},exportTimetable:function(){var content=JSON.stringify(this.timetable.toDTO()),t=new Blob([content],{type:"application/json"}),e=URL.createObjectURL(t);this.exportURL=e},loadImportTarget:function(t){var e=this,n=t.target.files[0];"application/json"!==n.type&&alert("File is not JSON");var r=new FileReader;r.onload=function(t){e.loadedContent=t.target.result},r.readAsText(n)},importTimetable:function(){var t=JSON.parse(this.loadedContent),e=nt.fromDTO(t);this.tracks=e.tracks.toString(),this.timespans=e.timespans,this.items=e.items}}},at=Object(O.a)(it,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),t._v(" "),n("section",{staticClass:"section"},[n("div",{staticClass:"container"},[n("tracks-form",{attrs:{tracks:t.tracks},on:{"update:tracks":function(e){t.tracks=e}}}),t._v(" "),n("timespan-form",{on:{create:t.addTimespan}}),t._v(" "),n("item-form",{on:{create:t.addItem}}),t._v(" "),n("timetable",{attrs:{timetable:t.timetable}}),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.exportTimetable(e)}}},[n("button",{attrs:{type:"submit"}},[t._v("\n          Export\n        ")]),t._v(" "),t.exportURL?n("a",{attrs:{href:t.exportURL,download:""}},[t._v("\n          Download\n        ")]):t._e()]),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.importTimetable(e)}}},[n("input",{attrs:{type:"file",name:"import-target"},on:{change:t.loadImportTarget}}),t._v(" "),n("button",{attrs:{type:"submit",disabled:!t.loadedContent}},[t._v("\n          Import\n        ")])])],1)])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"hero"},[e("div",{staticClass:"hero-body"},[e("div",{staticClass:"container"},[e("h1",{staticClass:"title"},[this._v("\n          Timetable Editor\n        ")]),this._v(" "),e("h2",{staticClass:"subtitle"},[this._v("\n          Web Timetable Editor\n        ")])])])])}],!1,null,null,null);e.default=at.exports}}]);