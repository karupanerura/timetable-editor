!function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],m=0,u=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&u.push(a[r][0]),a[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(d&&d(e);u.length;)u.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,o=1;o<s.length;o++){var l=s[o];0!==a[l]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},a={0:0},n=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;n.push([13,1]),s()}({13:function(t,e,s){"use strict";s.r(e);var i=s(5),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),t._v(" "),s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"content"},[s("timetable",{attrs:{timetable:t.timetable},on:{"update:timetable":function(e){t.timetable=e}}}),t._v(" "),s("timespan-form",{on:{create:t.addTimespan}}),t._v(" "),s("tracks-form",{attrs:{tracks:t.tracks},on:{"update:tracks":function(e){t.tracks=e}}})],1),t._v(" "),s("div",{staticClass:"content"},[s("h4",[t._v("Add Item")]),t._v(" "),s("item-form",{on:{create:t.addItem}})],1),t._v(" "),s("div",{staticClass:"content"},[s("h3",[t._v("Export")]),t._v(" "),s("form",{on:{submit:function(e){return e.preventDefault(),t.exportTimetable(e)}}},[s("div",{staticClass:"field has-addons"},[t._m(1),t._v(" "),s("div",{staticClass:"control"},[s("a",{staticClass:"button is-link",attrs:{disabled:!t.exportURL,href:t.exportURL,download:""}},[t._v("\n                Download\n              ")])])])]),t._v(" "),s("form",{on:{submit:function(e){return e.preventDefault(),t.createPermalink(e)}}},[t._m(2)]),t._v(" "),s("h3",[t._v("Import")]),t._v(" "),s("form",{on:{submit:function(e){return e.preventDefault(),t.importTimetable(e)}}},[s("div",{staticClass:"field has-addons"},[s("div",{staticClass:"control"},[s("input",{staticClass:"input",attrs:{type:"file",name:"import-target"},on:{change:t.loadImportTarget}})]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button",attrs:{type:"submit",disabled:!t.loadedContent}},[t._v("Import")])])])])])])])])};a._withStripped=!0;var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("div",{staticClass:"timetable"},[s("div",{staticClass:"timespans"},t._l(t.timespans,(function(e){return s("div",{key:e.toString(),staticClass:"timespan",on:{contextmenu:function(s){return s.preventDefault(),s.stopPropagation(),t.focusToTheTimespan(e)}}},[s("p",{staticClass:"title is-4"},[t._v(t._s(e))])])})),0),t._v(" "),s("div",{staticClass:"timetable-contents"},[s("div",{staticClass:"tracks"},[s("tracks",{attrs:{count:t.tracks}})],1),t._v(" "),s("grid-layout",{attrs:{layout:t.grids,"col-num":t.columns,"max-rows":t.rows,margin:[0,0],"row-height":64,"is-draggable":!0,"is-resizable":!0,"use-css-transforms":!0},on:{"update:layout":function(e){t.grids=e}}},t._l(t.grids,(function(e){return s("grid-item",{key:e.i,attrs:{grid:e},on:{focusgrid:t.focusToTheItemGrid}})})),1)],1)]),t._v(" "),s("item-editor-modal",{attrs:{grids:t.grids,grid:t.focusedItemGrid},on:{"update:grids":function(e){t.grids=e},"update:grid":function(e){t.focusedItemGrid=e},closemodal:t.unfocusItem}}),t._v(" "),s("timespan-editor-modal",{attrs:{timespan:t.focusedTimespan,timespans:t.timespans},on:{"update:timespan":function(e){t.focusedTimespan=e},"update:timespans":function(e){t.timespans=e},closemodal:t.unfocusTimespan}})],1)};n._withStripped=!0;class r{constructor(t,e){this.hour=t,this.minute=e}static parse(t){const[e,s]=t.split(":"),i=e?parseInt(e):0,a=s?parseInt(s):0;return new r(i,a)}static fromDTO(t){return new r(t.hour,t.minute)}addMinutes(t){const e=this.minute+t,s=Math.floor(this.hour+e/60);return new r(s%24,e%60)}compare(t){const e=this.compareHour(t);return 0!==e?e:this.compareMinute(t)}equals(t){return this.hour===t.hour&&this.minute===t.minute}compareHour(t){return this.hour<t.hour?-1:this.hour===t.hour?0:1}compareMinute(t){return this.minute<t.minute?-1:this.minute===t.minute?0:1}toString(){return(this.hour>=10?this.hour.toString():"0"+this.hour.toString())+":"+(this.minute>=10?this.minute.toString():"0"+this.minute.toString())}}class o{constructor(t,e){this.beginsTime=t,this.endsTime=e}static fromDTO(t){const e=r.fromDTO(t.beginsTime),s=r.fromDTO(t.endsTime);return new o(e,s)}isMoment(){return this.beginsTime.equals(this.endsTime)}isValid(){return this.beginsTime.compare(this.endsTime)<=0}compare(t){return this.beginsTime.compare(t.beginsTime)||this.endsTime.compare(t.endsTime)}includes(t){return this.beginsTime.compare(t.beginsTime)<=0&&this.endsTime.compare(t.endsTime)>=0}conflicts(t){return this.beginsTime.compare(t.endsTime)<0&&this.endsTime.compare(t.beginsTime)>0}equals(t){return this.beginsTime.equals(t.beginsTime)&&this.endsTime.equals(t.endsTime)}toString(){return this.isMoment()?this.beginsTime.toString():this.beginsTime.toString()+" ~ "+this.endsTime.toString()}}class l{constructor(t,e,s={}){this.title=t,this.description=e,this.extras=s,this.title=t,this.description=e,this.extras=s}static fromDTO(t){return new l(t.title,t.description,t.extras)}}const c=(d=0,()=>++d);var d;class m{constructor(t){this.x=0,this.y=0,this.w=1,this.h=1,this.moved=!1,this.id=c(),this.item=t}get i(){return`item[${this.id}]`}static getOrCreate(t){const e=m.cache.get(t);if(e instanceof m)return e;const s=new m(t);return m.cache.set(t,s),s}}function*u(t,e,s=1){for(let i=t;i<=e;i+=s)yield i}m.cache=new WeakMap;class p{constructor(t,e,s,i){this.tracks=t,this.timespans=e,this.items=s,this.grids=i}static create(t,e,s){const i=s.map(m.getOrCreate);return new p(t,e,s,i)}static fromDTO(t){const e=Math.max(...t.items.map(t=>t.trackIds.length)),s=t.timespans.map(o.fromDTO),i=t.items.map(l.fromDTO),a=t.items.map((t,e)=>{const a=o.fromDTO(t.timespan),n=Array.from((t=>{let e=0,i=0,a=0;for(const n of s){if(t.includes(n))0===i&&(i=e),a=e;else if(0!==i)break;e++}return u(i,a)})(a)),r=i[e],l=m.getOrCreate(r);return l.x=t.trackIds[0]-1,l.y=n[0],l.w=t.trackIds.length,l.h=n.length,l});return new p(e,s,i,a)}withGrids(t){const e=t.map(t=>t.item);return new p(this.tracks,this.timespans,e,t)}withTimespans(t){return new p(this.tracks,t,this.items,this.grids)}toDTO(){const t=this.grids.map(t=>{const e=this.timespans[t.y],s=this.timespans[t.y+t.h-1];let i;i=e.equals(s)?e:new o(e.beginsTime,s.endsTime);const a=Array.from(u(t.x+1,t.x+t.w));return{...t.item,timespan:i,trackIds:a}});return{tracks:this.tracks,timespans:this.timespans,items:t}}}var h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tracks"},t._l(t.tracks,(function(e){return s("div",{key:e,staticClass:"track"},[s("p",{staticClass:"title"},[t._v("Track "+t._s(e))])])})),0)};h._withStripped=!0;var f={components:{},props:{count:{type:Number,default:2}},data:()=>({}),computed:{tracks(){return function*(t,e,s=1){for(let i=t;i<=e;i+=s)yield i}(1,this.count)}}},v=s(1),g=s.n(v),b=s(6),_={insert:"head",singleton:!1},T=(g()(b.a,_),b.a.locals,s(0)),C=Object(T.a)(f,h,[],!1,null,"ac172b74",null);C.options.__file="src/components/timetable/tracks.vue";var x=C.exports,y=s(3),w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("grid-item",{key:t.grid.i,attrs:{x:t.grid.x,y:t.grid.y,w:t.grid.w,h:t.grid.h,i:t.grid.i}},[s("div",{staticClass:"grid",on:{contextmenu:function(e){return e.preventDefault(),e.stopPropagation(),t.focus(t.grid)}}},[s("h4",{staticClass:"title is-4"},[t._v(t._s(t.grid.item.title))])])])};w._withStripped=!0;var k={components:{GridItem:y.GridItem},props:{grid:{type:Object,default:()=>{}}},data:()=>({}),methods:{focus(t){this.$emit("focusgrid",t)}}},E=s(7),S={insert:"head",singleton:!1},O=(g()(E.a,S),E.a.locals,Object(T.a)(k,w,[],!1,null,"9aa3d428",null));O.options.__file="src/components/timetable/grid-item.vue";var D=O.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("keep-alive",[t.grid?[s("div",{staticClass:"modal is-active"},[s("div",{staticClass:"modal-background",on:{click:t.close}}),t._v(" "),s("div",{staticClass:"modal-card"},[s("header",{staticClass:"modal-card-head"},[t.editor?[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Title")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.draftTitle,expression:"draftTitle"}],staticClass:"input",attrs:{type:"text",placeholder:"Title",required:""},domProps:{value:t.draftTitle},on:{input:function(e){e.target.composing||(t.draftTitle=e.target.value)}}})])])]:[s("p",{staticClass:"modal-card-title"},[t._v(t._s(t.grid.item.title))]),t._v(" "),s("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:t.close}})]],2),t._v(" "),s("section",{staticClass:"modal-card-body"},[t.editor?[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Description")]),t._v(" "),s("div",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.draftDescription,expression:"draftDescription"}],staticClass:"textarea",attrs:{placeholder:"Description",required:""},domProps:{value:t.draftDescription},on:{input:function(e){e.target.composing||(t.draftDescription=e.target.value)}}})])]),t._v(" "),s("h4",{staticClass:"mt-1"},[t._v("Extras")]),t._v(" "),t._l(this.draftExtras,(function(e){return s("div",{key:e[0],staticClass:"field has-addons"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e[0],expression:"entry[0]",modifiers:{lazy:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Key",required:""},domProps:{value:e[0]},on:{change:function(s){return t.$set(e,0,s.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.lazy",value:e[1],expression:"entry[1]",modifiers:{lazy:!0}}],staticClass:"input",attrs:{type:"text",placeholder:"Value ("+typeof e[1]+")",required:""},domProps:{value:e[1]},on:{change:function(s){return t.$set(e,1,s.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",attrs:{disabled:!t.canAddExtras&&"disabled"},on:{click:function(s){return t.removeExtras(e[0])}}},[t._v("Remove")])])])})),t._v(" "),s("div",{staticClass:"field is-grouped"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-link",on:{click:function(e){return t.addExtras()}}},[t._v("Add")])])])]:[s("p",{staticStyle:{"white-space":"pre-wrap"}},[t._v(t._s(t.grid.item.description))]),t._v(" "),t.hasExtras?[s("h4",{staticClass:"mt-1"},[t._v("Extras")]),t._v(" "),s("table",{directives:[{name:"show",rawName:"v-show",value:t.hasExtras,expression:"hasExtras"}],staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("Key")]),t._v(" "),s("th",[t._v("Value")])])]),t._v(" "),s("tbody",t._l(t.grid.item.extras,(function(e,i){return s("tr",{key:i},[s("th",[t._v(t._s(i))]),t._v(" "),s("td",[t._v(t._s(e))])])})),0)])]:t._e()]],2),t._v(" "),s("footer",{staticClass:"modal-card-foot"},[t.editor?[s("div",{staticClass:"field is-grouped",staticStyle:{width:"100%"}},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:t.commit}},[t._v("Save")])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:t.cancel}},[t._v("Cancel")])])]),t._v(" "),s("div",{staticClass:"field is-grouped is-grouped-right"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:t.remove}},[t._v("Remove")])])])]:[s("button",{staticClass:"button is-success",on:{click:t.edit}},[t._v("Edit")]),t._v(" "),s("button",{staticClass:"button",on:{click:t.close}},[t._v("Close")])]],2)])])]:t._e()],2)};$._withStripped=!0;var j={props:{grid:{type:Object,default:()=>null},grids:{type:Array,default:()=>[]}},data:()=>({editor:!1,draftTitle:"",draftDescription:"",draftExtras:[]}),computed:{hasExtras(){return Object.keys(this.grid.item.extras).length>0}},methods:{edit(){this.draftTitle=this.grid.item.title,this.draftDescription=this.grid.item.description,this.draftExtras=Object.entries(this.grid.item.extras),this.editor=!0},commit(){this.editor=!1,this.grid.item=new l(this.draftTitle,this.draftDescription,Object.fromEntries(this.draftExtras)),this.$emit("update:grid",this.grid)},remove(){if(!window.confirm("Do you want to remove "+this.grid.item.title))return;const t=this.grids.filter(t=>t.id!==this.grid.id);this.$emit("update:grid",null),this.$emit("update:grids",t),this.close()},cancel(){this.editor=!1},close(){this.$emit("closemodal")},typeof:t=>typeof t,removeExtras(t){this.draftExtras=this.draftExtras.filter(([e])=>e!==t)},addExtras(){this.canAddExtras()&&this.draftExtras.push(["",""])},canAddExtras(){return 0===this.draftExtras.filter(([t])=>""===t).length}}},I=Object(T.a)(j,$,[],!1,null,null,null);I.options.__file="src/components/timetable/item-editor-modal.vue";var P=I.exports,N=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("keep-alive",[t.timespan?[s("div",{staticClass:"modal is-active"},[s("div",{staticClass:"modal-background",on:{click:t.close}}),t._v(" "),s("div",{staticClass:"modal-card"},[s("header",{staticClass:"modal-card-head"},[s("p",{staticClass:"modal-card-title"},[t._v(t._s(t.timespan))]),t._v(" "),s("button",{staticClass:"delete",attrs:{"aria-label":"close"},on:{click:t.close}})]),t._v(" "),s("section",{staticClass:"modal-card-body"},[s("div",{staticClass:"field has-addons"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.beginsTime,expression:"beginsTime"}],staticClass:"input",attrs:{type:"time",name:"begins-time",step:t.timeStepSeconds,max:t.endsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}",disabled:!t.editor},domProps:{value:t.beginsTime},on:{input:function(e){e.target.composing||(t.beginsTime=e.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("a",{staticClass:"button is-static"},[t._v("~")])]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.endsTime,expression:"endsTime"}],staticClass:"input",attrs:{type:"time",name:"ends-time",step:t.timeStepSeconds,min:t.beginsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}",disabled:!t.editor},domProps:{value:t.endsTime},on:{input:function(e){e.target.composing||(t.endsTime=e.target.value)}}})])])]),t._v(" "),s("footer",{staticClass:"modal-card-foot"},[t.editor?[s("div",{staticClass:"field is-grouped",staticStyle:{width:"100%"}},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:t.commit}},[t._v("Save")])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:t.cancel}},[t._v("Cancel")])])]),t._v(" "),s("div",{staticClass:"field is-grouped is-grouped-right"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-danger",on:{click:t.remove}},[t._v("Remove")])])])]:[s("div",{staticClass:"field is-grouped"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:t.edit}},[t._v("Edit")])]),t._v(" "),s("div",{staticClass:"control"},[s("button",{staticClass:"button",on:{click:t.close}},[t._v("Close")])])])]],2)])])]:t._e()],2)};N._withStripped=!0;var q={props:{timeStep:{type:Number,default:10},timespans:{type:Array,default:()=>[]},timespan:{type:Object,default:()=>null}},data:()=>({editor:!1,draftBeginsTime:null,draftEndsTime:null}),computed:{timeStepSeconds(){return 60*this.timeStep},beginsTime:{get(){return this.draftBeginsTime?this.draftBeginsTime:this.timespan?this.timespan.beginsTime.toString():"09:00"},set(t){this.draftBeginsTime=t}},endsTime:{get(){return this.draftEndsTime?this.draftEndsTime:this.timespan?this.timespan.endsTime.toString():"09:00"},set(t){this.draftEndsTime=t}}},methods:{edit(){this.draftBeginsTime=this.timespan.beginsTime.toString(),this.draftEndsTime=this.timespan.endsTime.toString(),this.editor=!0},commit(){const t=new o(r.parse(this.draftBeginsTime),r.parse(this.draftEndsTime));if(!t.isValid())return void alert(t+" is invalid timespan");const e=this.timespans.filter(t=>!t.equals(this.timespan));if(e.filter(e=>e.equals(t)).length>0)return void alert(t+" is duplicated");e.map(e=>t.conflicts(e)).reduce((t,e)=>t||e,!1)?alert(`Conflict time span: ${this.draftBeginsTime} ~ ${this.draftEndsTime}`):(e.push(t),this.$emit("update:timespan",t),this.$emit("update:timespans",e.sort((t,e)=>t.compare(e))),this.reset())},remove(){if(!window.confirm("Do you want to remove "+this.timespan))return;const t=this.timespans.filter(t=>!t.equals(this.timespan));this.$emit("update:timespan",null),this.$emit("update:timespans",t),this.reset(),this.close()},cancel(){this.reset()},reset(){this.draftBeginsTime=null,this.draftEndsTime=null,this.editor=!1},close(){this.$emit("closemodal")}}},B=Object(T.a)(q,N,[],!1,null,null,null);B.options.__file="src/components/timetable/timespan-editor-modal.vue";var A=B.exports,G={components:{Tracks:x,GridLayout:y.GridLayout,GridItem:D,ItemEditorModal:P,TimespanEditorModal:A},props:{timetable:{type:Object,default:()=>{}}},data:()=>({focusedItemGrid:null,focusedTimespan:null}),computed:{timespans:{get(){return this.timetable.timespans},set(t){const e=this.timetable.withTimespans(t);this.$emit("update:timetable",e)}},grids:{get(){return this.timetable.grids},set(t){const e=this.timetable.withGrids(t);this.$emit("update:timetable",e)}},rows(){return this.timetable.timespans.length},tracks(){return this.timetable.tracks},columns(){return this.timetable.tracks}},methods:{focusToTheItemGrid(t){this.focusedItemGrid=t},focusToTheTimespan(t){this.focusedTimespan=t},unfocusItem(){this.focusedItemGrid=null},unfocusTimespan(){this.focusedTimespan=null}}},M=s(8),R={insert:"head",singleton:!1},U=(g()(M.a,R),M.a.locals,Object(T.a)(G,n,[],!1,null,"2faaf0c1",null));U.options.__file="src/components/timetable.vue";var J=U.exports,L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container content"},[s("form",{attrs:{action:"javascript:void(0)"}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Tracks")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.tracks,expression:"tracks",modifiers:{number:!0}}],staticClass:"input",attrs:{type:"number",name:"tracks",min:"2",max:"8"},domProps:{value:t.tracks},on:{input:function(e){e.target.composing||(t.tracks=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])])};L._withStripped=!0;var z={props:{tracks:{type:Number,default:2}},data:()=>({}),watch:{tracks(){this.$emit("update:tracks",this.tracks)}}},F=Object(T.a)(z,L,[],!1,null,null,null);F.options.__file="src/components/tracks-form.vue";var V=F.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container content"},[s("form",{attrs:{action:"javascript:void(0)"},on:{submit:function(e){return e.preventDefault(),t.addItem()}}},[s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Title")]),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.draftTitle,expression:"draftTitle"}],staticClass:"input",attrs:{type:"text",name:"title",required:""},domProps:{value:t.draftTitle},on:{input:function(e){e.target.composing||(t.draftTitle=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"field"},[s("label",{staticClass:"label"},[t._v("Description")]),t._v(" "),s("div",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.draftDescription,expression:"draftDescription"}],staticClass:"textarea",attrs:{required:""},domProps:{value:t.draftDescription},on:{input:function(e){e.target.composing||(t.draftDescription=e.target.value)}}})])]),t._v(" "),t._m(0)])])};H._withStripped=!0;var K={components:{},props:{draftTitle:{type:String,default:""},draftDescription:{type:String,default:""}},data:()=>({}),methods:{addItem(){const t=this.draftTitle,e=this.draftDescription,s=new l(t,e);this.$emit("create",s)}}},W=Object(T.a)(K,H,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field"},[e("div",{staticClass:"control"},[e("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[this._v("Add")])])])}],!1,null,null,null);W.options.__file="src/components/item-form.vue";var Q=W.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("form",{attrs:{action:"javascript:void(0)"},on:{submit:function(e){return e.preventDefault(),t.addTimespan()}}},[s("div",{staticClass:"field has-addons"},[s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.draftBeginsTime,expression:"draftBeginsTime"}],staticClass:"input",attrs:{type:"time",name:"begins-time",step:t.timeStepSeconds,max:t.draftEndsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}"},domProps:{value:t.draftBeginsTime},on:{input:function(e){e.target.composing||(t.draftBeginsTime=e.target.value)}}})]),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.draftEndsTime,expression:"draftEndsTime"}],staticClass:"input",attrs:{type:"time",name:"ends-time",step:t.timeStepSeconds,min:t.draftBeginsTime,required:"",pattern:"[0-9]{2}:[0-9]{2}"},domProps:{value:t.draftEndsTime},on:{input:function(e){e.target.composing||(t.draftEndsTime=e.target.value)}}})]),t._v(" "),t._m(1)])])])};X._withStripped=!0;var Y={props:{timeStep:{type:Number,default:10}},data:()=>({draftBeginsTime:"09:00",draftEndsTime:"09:10"}),computed:{timeStepSeconds(){return 60*this.timeStep}},methods:{addTimespan(){if(""===this.draftBeginsTime)return void alert("begins time is not defined");if(""===this.draftEndsTime)return void alert("ends time is not defined");const t=new o(r.parse(this.draftBeginsTime),r.parse(this.draftEndsTime));t.isValid()?(this.draftBeginsTime=this.draftEndsTime,this.draftEndsTime=r.parse(this.draftBeginsTime).addMinutes(this.timeStep).toString(),this.$emit("create",t)):alert(t+" is invalid timespan")}}},Z=Object(T.a)(Y,X,[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"control"},[e("a",{staticClass:"button is-static"},[this._v("~")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"control"},[e("button",{staticClass:"button is-primary",attrs:{type:"submit"}},[this._v("Add")])])}],!1,null,null,null);Z.options.__file="src/components/timespan-form.vue";var tt=Z.exports,et=s(9);const st=t=>btoa(String.fromCharCode(...t)).replace(/\//g,"_").replace(/\+/g,"-"),it=t=>{const e=atob(t.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(e.length);for(const t of u(0,e.length))s[t]=e.charCodeAt(t);return s};var at={components:{Timetable:J,TracksForm:V,ItemForm:Q,TimespanForm:tt},data:()=>({tracks:2,timespans:[],items:[],loadedContent:null,exportURL:null}),created(){const t=Object.fromEntries(location.search.substring(1).split(/&/).map(t=>t.split(/=/,2).map(decodeURIComponent)));if(t.timetable){const e=(t=>{const e=it(t),s=et.a.inflate(e,{to:"string"});return JSON.parse(s)})(t.timetable),s=p.fromDTO(e);this.tracks=s.tracks,this.timespans=s.timespans,this.items=s.items}},computed:{timetable:{get(){return p.create(this.tracks,this.timespans,this.items)},set(t){this.tracks=t.tracks,this.timespans=t.timespans,this.items=t.items}}},methods:{addItem(t){this.items.push(t)},addTimespan(t){if(this.timespans.filter(e=>e.equals(t)).length>0)return;const e=this.timespans;e.map(e=>t.conflicts(e)).reduce((t,e)=>t||e,!1)?alert("Conflict time span: "+this.beginsTime+" ~ "+this.endsTime):(e.push(t),this.timespans=e.sort((t,e)=>t.compare(e)))},exportTimetable(){const t=JSON.stringify(this.timetable.toDTO()),e=new Blob([t],{type:"application/json"}),s=URL.createObjectURL(e);this.exportURL=s},createPermalink(){const t=(t=>{const e=JSON.stringify(t),s=et.a.deflate(e);return st(s)})(this.timetable.toDTO());location.search="?timetable="+encodeURIComponent(t)},loadImportTarget(t){const e=t.target.files[0];"application/json"!==e.type&&alert("File is not JSON");const s=new FileReader;s.onload=t=>{this.loadedContent=t.target.result},s.readAsText(e)},importTimetable(){const t=JSON.parse(this.loadedContent),e=p.fromDTO(t);this.tracks=e.tracks,this.timespans=e.timespans,this.items=e.items}}},nt=Object(T.a)(at,a,[function(){var t=this.$createElement,e=this._self._c||t;return e("section",{staticClass:"hero"},[e("div",{staticClass:"hero-body"},[e("div",{staticClass:"container"},[e("h1",{staticClass:"title"},[this._v("\n          Timetable Editor\n        ")]),this._v(" "),e("h2",{staticClass:"subtitle"},[this._v("\n          Web Timetable Editor\n        ")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"control"},[e("button",{staticClass:"button",attrs:{type:"submit"}},[this._v("Generate Timetable JSON")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"field has-addons"},[e("div",{staticClass:"control"},[e("button",{staticClass:"button",attrs:{type:"submit"}},[this._v("Create Permalink")])])])}],!1,null,null,null);nt.options.__file="src/App.vue";var rt=nt.exports;new i.default({render:t=>t(rt)}).$mount("#app")},6:function(t,e,s){"use strict";var i=s(2),a=s.n(i)()((function(t){return t[1]}));a.push([t.i,"\n.tracks[data-v-ac172b74] {\n  display: table;\n  width: 100%;\n  height: 64px;\n}\n.track[data-v-ac172b74] {\n  display: table-cell;\n  border: solid 1px rgba(0, 0, 0, 64);\n  padding: 12px;\n  text-align: center;\n}\n",""]),e.a=a},7:function(t,e,s){"use strict";var i=s(2),a=s.n(i)()((function(t){return t[1]}));a.push([t.i,"\n.grid[data-v-9aa3d428] {\n  height: 100%;\n  width: 100%;\n  padding: 1rem;\n  text-align: center;\n  border : solid 1px rgba(0, 0, 0, 64);\n}\n",""]),e.a=a},8:function(t,e,s){"use strict";var i=s(2),a=s.n(i)()((function(t){return t[1]}));a.push([t.i,"\n.timespans[data-v-2faaf0c1] {\n  display: flex;\n  flex-flow: column nowrap;\n  margin-top: 64px;\n  width: 240px;\n}\n.timespan[data-v-2faaf0c1] {\n  height: 64px;\n  border : solid 1px rgba(0, 0, 0, 64);\n}\n.timespan p[data-v-2faaf0c1] {\n  padding: 16px 8px;\n  text-align: right;\n}\n.timetable[data-v-2faaf0c1] {\n  display: flex;\n  flex-flow: row nowrap;\n  width: 100%;\n}\n.timetable-contents[data-v-2faaf0c1] {\n  width: 100%;\n}\n",""]),e.a=a}});